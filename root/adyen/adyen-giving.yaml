workflowsSpec: "1.0.0"
info:
  title: "Adyen Giving"
  version: "v1"
  description: "With Adyen Giving, you can give your shoppers the option to donate to a nonprofit as part of your payment flow."
sourceDescriptions:
  - name: "adyen-checkout-api"
    url: "https://raw.githubusercontent.com/Adyen/adyen-openapi/main/yaml/CheckoutService-v71.yaml"
    type: "openapi"
workflows:
  - workflowId: "giving"
    summary: "Make a donation"
    description: "This workflow shows how to perform a donation"
    inputs:
      type: "object"
      properties:
        x-api-key:
          type: "string"
        amount:
          $ref: "#/components/amount"
        card:
          $ref: "#/components/card"
    steps:
      - stepId: "payment"
        description: "Make a card payment"
        operationId: "payment"
        parameters:
          - name: "x-api-key"
            in: "header"
            value: "$inputs.x-api-key"
          - name: "number"
            in: "body"
            target: $request.body#/number
            value: $inputs.card.number
          - name: "cvc"
            in: "body"
            target: $request.body#/cvc
            value: $inputs.card.cvc
          - name: "expiryMonth"
            in: "body"
            target: $request.body#/expiryMonth
            value: $inputs.card.expiryMonth
          - name: "expiryYear"
            in: "body"
            target: $request.body#/expiryYear
            value: $inputs.card.expiryYear
          - name: "holderName"
            in: "body"
            target: $request.body#/holderName
            value: $inputs.card.holderName
        successCriteria:
          - condition: "$statusCode == 200"
        outputs:
          tokenExpires: "$response.header.X-Expires-After"
          rateLimit: "$response.header.X-Rate-Limit"
    outputs:
      tokenExpires: "$steps.loginStep.outputs.tokenExpires"
components:
  inputs:
    amount:
      type: object
      properties:
        value:
          format: int64
          type: integer
        currency:
          type: string
    card:
      type: object
      properties:
        number:
          description: "The card number (without any separators)"
          maxLength: 19
          minLength: 4
          type: string
        cvc:
          format: int64
          type: integer
          maxLength: 20
          minLength: 1
        expiryMonth:
          maxLength: 2
          minLength: 1
          type: string
        expiryYear:
          maxLength: 4
          minLength: 4
          type: string
        holderName:
          maxLength: 50
          minLength: 1
          type: string
